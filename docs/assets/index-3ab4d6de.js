var t=Object.defineProperty,e=(e,n,a)=>(((e,n,a)=>{n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a})(e,"symbol"!=typeof n?n+"":n,a),a);!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();let n,a,s,o,i,r,l=Object.getPrototypeOf,c={isConnected:1},u={},d=l(c),h=l(l),p=(t,e,n,a)=>(t??(setTimeout(n,a),new Set)).add(e),b=(t,e,n)=>{let a=s;s=e;try{return t(n)}catch(o){return console.error(o),n}finally{s=a}},m=t=>t.filter(t=>{var e;return null==(e=t.t)?void 0:e.isConnected}),f=t=>i=p(i,t,()=>{for(let t of i)t.o=m(t.o),t.i=m(t.i);i=r},1e3),v={get val(){var t;return null==(t=null==s?void 0:s.l)||t.add(this),this.rawVal},get oldVal(){var t;return null==(t=null==s?void 0:s.l)||t.add(this),this.u},set val(t){var e;null==(e=null==s?void 0:s.h)||e.add(this),t!==this.rawVal&&(this.rawVal=t,this.o.length+this.i.length?(null==a||a.add(this),n=p(n,this,S)):this.u=t)}},w=t=>({__proto__:v,rawVal:t,u:t,o:[],i:[]}),g=(t,e)=>{let n={l:new Set,h:new Set},a={f:t},s=o;o=[];let i=b(t,n,e);i=(i??document).nodeType?i:new Text(i);for(let o of n.l)n.h.has(o)||(f(o),o.o.push(a));for(let r of o)r.t=i;return o=s,a.t=i},y=(t,e=w(),n)=>{let a={l:new Set,h:new Set},s={f:t,s:e};s.t=n??(null==o?void 0:o.push(s))??c,e.val=b(t,a,e.rawVal);for(let o of a.l)a.h.has(o)||(f(o),o.i.push(s));return e},T=(t,...e)=>{for(let n of e.flat(1/0)){let e=l(n??0),a=e===v?g(()=>n.val):e===h?g(n):n;a!=r&&t.append(a)}return t},_=(t,e,...n)=>{var a;let[s,...o]=l(n[0]??0)===d?n:[{},...n],i=t?document.createElementNS(t,e):document.createElement(e);for(let[c,d]of Object.entries(s)){let t=e=>e?Object.getOwnPropertyDescriptor(e,c)??t(l(e)):r,n=e+","+c,s=u[n]??(u[n]=(null==(a=t(l(i)))?void 0:a.set)??0),o=c.startsWith("on")?(t,e)=>{let n=c.slice(2);i.removeEventListener(n,e),i.addEventListener(n,t)}:s?s.bind(i):i.setAttribute.bind(i,c),p=l(d??0);c.startsWith("on")||p===h&&(d=y(d),p=v),p===v?g(()=>(o(d.val,d.u),i)):o(d)}return T(i,o)},k=t=>({get:(e,n)=>_.bind(r,t,n)}),O=(t,e)=>e?e!==t&&t.replaceWith(e):t.remove(),S=()=>{let t=0,e=[...n].filter(t=>t.rawVal!==t.u);do{a=new Set;for(let t of new Set(e.flatMap(t=>t.i=m(t.i))))y(t.f,t.s,t.t),t.t=r}while(++t<100&&(e=[...a]).length);let s=[...n].filter(t=>t.rawVal!==t.u);n=r;for(let n of new Set(s.flatMap(t=>t.o=m(t.o))))O(n.t,g(n.f,n.t)),n.t=r;for(let n of s)n.u=n.rawVal};const j={tags:new Proxy(t=>new Proxy(_,k(t)),k()),hydrate:(t,e)=>O(t,g(e,t)),add:T,state:w,derive:y},x=({value:t,Loading:e,Error:n},a)=>{const s=j.state({status:"pending"});return t.then(t=>s.val={status:"fulfilled",value:t}).catch(t=>s.val={status:"rejected",value:t}),()=>"pending"===s.val.status?(null==e?void 0:e())??"":"rejected"===s.val.status?null==n?void 0:n(s.val.value):a(s.val.value)},{div:A}=j.tags,E=()=>A({class:"loading-bg"},A({class:"loading-container"},A({class:"loader"}))),{a:L,div:P,li:R,p:U,ul:I,button:B,input:D,span:H}=j.tags,{div:M,h1:C,a:N}=j.tags,{div:V,br:J,a:$}=j.tags,z={open(t){const e=document.getElementById(t);e&&e.classList.add("is-active")},close(t){const e=document.getElementById(t);e&&e.classList.remove("is-active")},toggle(t){const e=document.getElementById(t);e&&e.classList.toggle("is-active")}};const G=new class{constructor(t){e(this,"_events"),this.m=t||{}}subscribe(t,e){return(this.m[t]||(this.m[t]=[])).push(e),{unsubscribe:()=>this.m[t]&&this.m[t].splice(this.m[t].indexOf(e)>>>0,1)}}emit(t,...e){(this.m[t]||[]).forEach(t=>t(...e))}},{div:q,header:F,p:K,section:W,footer:Q,button:X}=j.tags,Y=(t,e)=>{const n=()=>z.close(t.id);return q({id:t.id,class:"modal"},q({class:"modal-background"}),q({class:"modal-card"},F({class:"modal-card-head"},K({class:"modal-card-title"},t.title),X({class:"delete",ariaLabel:"close",onclick:n})),W({class:"modal-card-body"},e),()=>t.footer?Q({class:"modal-card-foot"},q({class:"buttons"},X({class:"button is-success",onclick:()=>G.emit("action")},"Save"),X({class:"button",onclick:n},"Cancel"))):q()))};const Z=new class{constructor(){e(this,"_requestConfig"),e(this,"_success"),e(this,"_failure"),e(this,"defaults",{baseUrl:"/",headers:{common:{}}}),e(this,"interceptors",{request:{use:t=>{t&&(this.v=t)}},response:{use:(t,e)=>{t&&(this.T=t),e&&(this._=e)}}}),this.v=()=>{},this.T=()=>{},this._=()=>{}}async get(t,e){let n=await this.v({url:t,baseURL:this.defaults.baseUrl,method:"GET"});return e&&(e.method&&delete e.method,n=Object.assign(n,e)),this.sendAsync(t,void 0,n)}async delete(t,e){let n=await this.v({url:t,baseURL:this.defaults.baseUrl,method:"DELETE"});return e&&(e.method&&delete e.method,n=Object.assign(n,e)),this.sendAsync(t,void 0,n)}async head(t,e){let n=await this.v({url:t,baseURL:this.defaults.baseUrl,method:"HEAD"});return e&&(e.method&&delete e.method,n=Object.assign(n,e)),this.sendAsync(t,void 0,n)}async options(t,e){let n=await this.v({url:t,baseURL:this.defaults.baseUrl,method:"OPTIONS"});return e&&(e.method&&delete e.method,n=Object.assign(n,e)),this.sendAsync(t,void 0,n)}async post(t,e,n){let a=await this.v({url:t,baseURL:this.defaults.baseUrl,method:"POST"});return n&&(n.method&&delete n.method,a=Object.assign(a,n)),this.sendAsync(t,e,a)}async put(t,e,n){let a=await this.v({url:t,baseURL:this.defaults.baseUrl,method:"PUT"});return n&&(n.method&&delete n.method,a=Object.assign(a,n)),this.sendAsync(t,e,a)}async patch(t,e,n){let a=await this.v({url:t,baseURL:this.defaults.baseUrl,method:"PATCH"});return n&&(n.method&&delete n.method,a=Object.assign(a,n)),this.sendAsync(t,e,a)}paramsSerializer(t){const e=new Array;return Object.entries(t).forEach(t=>{const n=t[0],a=t[1];a&&e.push(`${encodeURIComponent(n)}=${a}`)}),e.length>0?`?${e.join("&")}`:""}async sendAsync(t,e,n){const a={};if(Object.entries(this.defaults.headers.common).forEach(t=>{a[t[0]]=t[1]}),n.params&&(t+=this.paramsSerializer(n.params)),t.startsWith("http")||(t=`${this.defaults.baseUrl}${t}`),e instanceof FormData){if(n.body=e,n.headers){const t=new Headers(n.headers);t.delete("content-type"),n.headers=t}}else e&&"object"==typeof e&&(n.body=JSON.stringify(e));return new Promise((e,s)=>{fetch(t,{headers:a,...n}).then(async t=>{var e,n;if(t.ok)return this.T({response:{status:t.status}}),(null==(e=t.headers.get("content-type"))?void 0:e.includes("application/octet-stream"))?await t.blob():(null==(n=t.headers.get("content-type"))?void 0:n.includes("application/json"))?await t.json():await t.text();switch(this._(t),t.status){case 400:s("Validation error");break;case 401:s("401 (Unathorized)");break;case 500:s("Server error");break;default:console.error(t)}}).then(t=>e(t))})}};function tt(t,e){return new Promise(n=>window.setTimeout(()=>n(e),t))}const et=[{id:1,dttm:"2024-11-01",transaction:"DEBIT",name:"DEBIT PURCHASE -VISA KROGER #5575    740-354-8621OH",memo:null,amount:-99.91,tag:null}],nt=["Shopping","Shopping:Grocery"];class at{constructor(t){e(this,"id"),e(this,"dttm"),e(this,"transaction"),e(this,"name"),e(this,"memo"),e(this,"amount"),e(this,"tag"),this.id=0,this.dttm=null,this.transaction="CREDIT",this.name="",this.memo=null,this.amount=0,this.tag=null,t&&Object.assign(this,t)}}function st(t=new Array){window.localStorage.setItem("db",JSON.stringify(t))}function ot(){return JSON.parse(window.localStorage.getItem("db")??"[]")}const it={initDB:async function(){return new Promise(t=>{0===ot().length&&st(et),t(200)})},getAll:ot,getBy:function(t){return ot().find(e=>e.id===t)??new at},create:function(t){var e;const n=(null==(e=ot().sort((t,e)=>t.id>e.id?1:-1).pop())?void 0:e.id)??0;t.id=n+1;const a=ot();a.push(t),st(a)},update:function(t){let e=ot();e.forEach(e=>{e.id===t.id&&Object.assign(e,t)}),st(e)},deleteBy:function(t){const e=ot();for(let n=0;n<e.length;n+=1)if(e[n].id===t){e.splice(n,1);break}st(e)}},rt=800,lt=Z;lt.defaults.baseUrl="https://localhost:7182",lt.interceptors.request.use(t=>(t.headers={Accept:"application/json, */*","Content-Type":"application/json"},t.mode="cors",t.credentials="include",t));const ct={getById:t=>tt(rt,it.getBy(t)),post:(t,e,n)=>{let a=new at({id:t,memo:e,tag:n});return t>0&&it.getAll().forEach(s=>{s.id===t&&(s.memo=e,s.tag=n,it.update(s),a=s)}),a},delete:t=>tt(rt,it.deleteBy(t))},ut={get:()=>tt(rt,it.getAll()),post:t=>(t.forEach(t=>it.create(t)),0)},dt={get:()=>tt(rt,nt)},ht={site:(()=>{let t=j.state(!1),e=j.state(new Array);async function n(){return e.val=new Array,new Promise(async t=>{e.val=await dt.get(),t(1)})}return{pageloading:t,tags:e,preloadData:async function(){return Promise.all([it.initDB(),n()])},getTags:n}})(),transaction:(()=>{let t=j.state(new at);return{transaction:t,getTransactions:async function(){return await ut.get()},getTransactionById:async function(e){return new Promise(async n=>{const a=await ct.getById(e);t.val=new at(a),n(!0)})},saveTransaction:async function(){const{id:e,memo:n,tag:a}=t.val;return await ct.post(e,n,a)},saveTransactions:async function(t){return await ut.post(t)},removeTransaction:async function(e){return new Promise(async n=>{await ct.delete(e),t.val=new at,n(!0)})}}})()},{div:pt,label:bt,input:mt,select:ft,option:vt}=j.tags,{transaction:wt}=ht.transaction,{tags:gt}=ht.site;G.subscribe("action",function(){ht.transaction.saveTransaction().then(()=>{z.close("TransactionModal"),wt.val=new at})});let yt=ft({class:"input",onchange:t=>wt.val.tag=t.target.value},vt({value:""},""));j.derive(()=>{let t=new Array;t=gt.val.map(t=>vt({value:t,selected:()=>wt.val.tag===t},t)),j.add(yt,t)});const{svg:Tt,path:_t}=j.tags("http://www.w3.org/2000/svg"),{button:kt,div:Ot,input:St,label:jt,span:xt,strong:At}=j.tags;const Et=()=>Ot({class:"box has-advanced-upload",style:"text-align: center;",ondragover:t=>t.preventDefault(),ondrop:t=>function(t){t.preventDefault(),t.dataTransfer&&t.dataTransfer.files&&[...t.dataTransfer.files].forEach(t=>{const e=new FileReader;e.addEventListener("load",t=>{const e=t.target.result;if(e&&"string"==typeof e){let t=0,n=new Array;const a=new Array;e.split("\r\n").forEach(e=>{if(0===t)n=e.split(",");else{const t=e.replaceAll('"',"").split(",");let s=0;const o={};for(const e of n)o[e]=t[s],s+=1;a.push(new at(o))}t+=1}),ht.transaction.saveTransactions(a).then(t=>{0===t&&window.location.reload()})}}),e.readAsText(t)})}(t)},Ot({class:"box__input"},Tt({class:"box__icon",xmlns:"http://www.w3.org/2000/svg",width:"50",height:"43",viewBox:"0 0 50 43"},_t({d:"M48.4 26.5c-.9 0-1.7.7-1.7 1.7v11.6h-43.3v-11.6c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v13.2c0 .9.7 1.7 1.7 1.7h46.7c.9 0 1.7-.7 1.7-1.7v-13.2c0-1-.7-1.7-1.7-1.7zm-24.5 6.1c.3.3.8.5 1.2.5.4 0 .9-.2 1.2-.5l10-11.6c.7-.7.7-1.7 0-2.4s-1.7-.7-2.4 0l-7.1 8.3v-25.3c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v25.3l-7.1-8.3c-.7-.7-1.7-.7-2.4 0s-.7 1.7 0 2.4l10 11.6z"})),St({type:"file",name:"files[]",id:"file",class:"box__file","data-multiple-caption":"{count} files selected",multiple:""}),jt({for:"file"},At("Choose a file"),xt({class:"box__dragndrop"}," or drag it here"),"."),kt({type:"submit",class:"box__button"},"Upload")));j.tags;const{div:Lt,table:Pt,thead:Rt,tbody:Ut,tr:It,th:Bt,td:Dt,button:Ht,input:Mt,select:Ct,option:Nt}=j.tags,{tags:Vt}=ht.site,{transaction:Jt}=ht.transaction;let $t=j.state(0),zt=j.state(0);function Gt(){ht.transaction.saveTransaction().then(()=>{$t.val=0})}const qt=[{path:"*",component:M(C("Oops! We broke a link"),N({href:"./"},"Take me home"))},{path:"/",component:(()=>{const t=j.state(0),e=j.state("VanJs is cool"),n=j.derive(()=>e.val.length);return P(U("👋Hello"),I(R("🗺️World"),R(L({href:"https://vanjs.org/",target:"_blank"},"🍦VanJS")),R(B({disabled:()=>t.val>9,onclick:()=>{t.val<=9&&t.val++}},"👍"),B({disabled:()=>0===t.val,onclick:()=>{t.val>0&&t.val--}},"👎")),R("count: ",t),R(H("The length of ",D({type:"text",value:e,oninput:t=>e.val=t.target.value})," is ",n,".")),R(L({href:"./#/about",target:"_self"},"About page"))))})()},{path:"/transactions",component:(async()=>{const t=await ht.transaction.getTransactions(),e=new Array;return t.forEach(t=>{e.push(It(Dt(Ht({class:"button is-primary is-small is-outlined",onclick:()=>async function(t){Jt.val=new at,t>0&&await ht.transaction.getTransactionById(t),z.open("TransactionModal")}(t.id)},"edit"),Ht({class:"button is-danger is-small is-outlined",onclick:()=>{var e;(e=t.id)>0&&ht.transaction.removeTransaction(e).then(()=>{window.location.reload()})}},"del")),Dt(t.dttm),Dt(t.transaction),Dt(t.name),Dt(()=>0==$t.val?Ht({class:"button is-small",onclick:()=>{Jt.val=t,$t.val=t.id}},t.memo):Mt({type:"text",class:"input",value:()=>t.memo,oninput:e=>{t.memo=e.target.value,Jt.val.memo=t.memo},onblur:()=>Gt(),onkeyup:t=>{t.key.includes("Enter")&&Gt()}})),Dt(t.amount),Dt(()=>0==zt.val?Ht({class:"button is-small",onclick:()=>{Jt.val=t,zt.val=t.id}},t.tag):Ct({class:"input",onblur:()=>zt.val=0,onchange:e=>{t.tag=e.target.value,Jt.val.tag=t.tag,ht.transaction.saveTransaction().then(()=>{zt.val=0})}},Nt({value:""},""),Vt.val.map(e=>Nt({value:e,selected:t.tag===e},e))))))}),Lt({class:"columns"},Lt({class:"column"},Pt({class:"table"},Rt(It(Bt(Ht({class:"button is-secondary is-small",onclick:()=>z.open("ImportModal")},"Import")),Bt("Date"),Bt("Transaction"),Bt("Name"),Bt("Memo"),Bt("Amount"),Bt("Tag"))),()=>0===t.length?Ut(It(Dt({colSpan:7},"No records found."))):Ut(e))),Y({id:"TransactionModal",title:"Transaction Properties",footer:!0},pt(pt(bt("Date"),mt({type:"text",class:"input",disabled:!0,value:()=>wt.val.dttm})),pt(bt("Transaction"),mt({type:"text",class:"input",disabled:!0,value:()=>wt.val.transaction})),pt(bt("Name"),mt({type:"text",class:"input",disabled:!0,value:()=>wt.val.name})),pt(bt("Memo"),mt({type:"text",class:"input",placeholder:"Enter memo.",value:()=>wt.val.memo,oninput:t=>wt.val.memo=t.target.value})),pt(bt("Amount"),mt({type:"text",class:"input",disabled:!0,value:()=>wt.val.amount})),pt(bt("Tag"),yt))),Y({id:"ImportModal",title:"Import Transactions"},Et()))})()},{path:"/about",component:V("This is the about page",J(),$({href:"./"},"back to home"),J(),$({href:"./#/test"},"Test page"))}];window.addEventListener("popstate",()=>{window.location.reload()});const{header:Ft,nav:Kt,div:Wt,a:Qt,span:Xt,hr:Yt,strong:Zt}=j.tags,{footer:te,div:ee,p:ne,a:ae}=j.tags,{aside:se}=j.tags,{div:oe,main:ie}=j.tags;let re=document.getElementById("app")??document.body;j.add(re,x({value:ht.site.preloadData(),Loading:()=>E(),Error:()=>"Error"},()=>oe(Ft({class:""},Kt({class:"navbar",role:"navigation",ariaLabel:"main navigation"},Wt({class:"navbar-brand"},Qt({class:"navbar-item is-selected",href:"./"},"Budget Dashboard"),Qt({role:"button",class:"navbar-burger",ariaLabel:"menu",ariaExpanded:"false",dataTarget:"navbarBasicExample"},Xt({ariaHidden:!0}),Xt({ariaHidden:!0}),Xt({ariaHidden:!0}),Xt({ariaHidden:!0}))),Wt({class:"navbar-menu"},Wt({class:"navbar-start"},Qt({class:"navbar-item",href:"./#/transactions"},"Transactions"),Wt({class:"navbar-item has-dropdown is-hoverable"},Qt({class:"navbar-link"},"More"),Wt({class:"navbar-dropdown"},Qt({class:"navbar-item",href:"./#/about"},"About"),Yt({class:"navbar-divider"}),Qt({class:"navbar-item"},"Report an issue"))))),Wt({class:"navbar-end"},Wt({class:"navbar-item"},Wt({class:"buttons"},Qt({class:"button is-primary"},Zt("Sign Up")),Qt({class:"button is-light"},"Log in")))))),ie({class:"container"},(()=>{var t;const{hash:e}=window.location,n=e.length>1?qt.find(({path:t})=>t.match(`${e.replace("#","")}`)):qt.find(({path:t})=>t.match("/"));return n?n.component instanceof Promise?x({value:n.component,Loading:()=>E(),Error:()=>"error"},t=>t):n.component:null==(t=qt.find(({path:t})=>"*"===t))?void 0:t.component})()),se({class:"sidebar-left"}),te({class:"footer"},ee({class:"content has-text-centered"},ne("Built with love using ",ae({href:"https://bulma.io",target:"_blank"},"Bulma")," ,",ae({href:"https://vanjs.org",target:"_blank"},"VanJS")," and ",ae({href:"https://typescriptlang.org",target:"_blank"},"TypeScript")))))));
