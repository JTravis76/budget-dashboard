import{v as s,$ as t,b as l,c as e}from"./index-383cc3b0.js";import{$ as a}from"./toast-9fc7c1df.js";import{c as o}from"./dialog-28a53218.js";const{div:c,label:n,input:u,select:i,option:r,button:m}=s.tags,d=()=>{const{tags:l,rule:e}=t.tag;let o="",d={amount:0,tag:""},b=i({class:"input",onchange:s=>{d.tag=s.target.value,p()}},r({value:""},""));function p(){t.tag.setRule(o,d)}return s.derive(()=>{let t=new Array;t=l.val.map(t=>r({value:t,selected:s.derive(()=>{let s=Object.values(e.val)[0]??{amount:0,tag:""};return d=s,s.tag===t})},t)),s.add(b,t)}),c({class:"box"},c({class:"field"},n({class:"field"},"Keyword"),c({class:"control"},u({class:"input",type:"text",placeholder:"EX. Wendy's or Kroger Fuel",value:s.derive(()=>(o=Object.keys(e.val)[0]??"",o)),oninput:s=>{o=s.target.value,p()}}))),c({class:"field"},n({class:"field"},"Amount"),c({class:"control"},u({class:"input",type:"number",placeholder:"Amount..",value:s.derive(()=>(Object.values(e.val)[0]??{amount:0,tag:""}).amount.toString()),oninput:s=>{d.amount=parseFloat(s.target.value),p()}}))),c({class:"field"},n({class:"field"},"Tags"),c({class:"control"},b)),c({class:"buttons"},m({class:"button is-primary",type:"button",onclick:()=>{t.tag.saveRule(o,d).then(()=>a({message:"Save successful.",type:"success"}))}},"Save"),m({class:"button is-secondary",type:"reset",onclick:()=>(o="",d={amount:0,tag:""},void t.tag.resetRule())},"Reset")))},{div:b,strong:p,button:g}=s.tags,y=async()=>{await t.tag.getRules();let{rules:s,loading:a}=t.tag;return a.val=!1,b({class:"container mt-2"},d(),()=>a.val?b({class:"skeleton-block"}):b({class:"box"},s.val.map(s=>{var a;const c=Object.keys(s)[0],n=null==(a=Object.values(s)[0])?void 0:a.sort((s,t)=>s.amount<t.amount?1:-1);return b({class:"columns rule-bordered"},b({class:"column"},p(c)),b({class:"column"},n.map(s=>b({class:"columns"},b({class:"column"},`$${s.amount.toFixed(2)}`),b({class:"column"},s.tag),b({class:"column"},b({class:"buttons"},g({class:"button is-small is-default",onclick:()=>t.tag.setRule(c,s),title:"Edit"},l()),g({class:"button is-small is-outlined is-danger",onclick:()=>function(s,l){o({title:"Confirmation",type:"yesno",message:"Are you sure you want to remove this tag?"}).then(e=>{e&&t.tag.removeRule(s,l)})}(c,s),title:"Remove"},e())))))))})))};export{y as RuleBuilder};
