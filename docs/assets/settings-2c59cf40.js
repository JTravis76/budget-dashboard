import{v as e,$ as s,T as t}from"./index-383cc3b0.js";import{c as a}from"./dialog-28a53218.js";import{$ as o}from"./toast-9fc7c1df.js";const{div:l,h4:n,p:c,button:i,input:r}=e.tags,u=()=>{function e(){a({title:"Overwrite confirmation?",message:"Are you sure you want to restore from this backup? This cannot be undone.",type:"yesno"}).then(e=>{if(e){const e=document.getElementById("file");e.onchange=()=>{e&&e.files&&[...e.files].forEach(e=>{"application/json"==e.type&&function(e){const a=new FileReader;a.addEventListener("load",e=>{const a=e.target.result;if(a&&"string"==typeof a){let e=JSON.parse(a),l=new Array;e.transaction.forEach(e=>{let s=new t(e);s.id=0,l.push(s)}),l.length>0&&s.transaction.importTransactions(l),e.rules.length>0&&s.tag.importRules(e.rules),e.tags.length>0&&s.tag.importTags(e.tags),o({message:"Database restored successful",type:"success"})}}),a.readAsText(e)}(e)})},e.click()}})}return l({class:"columns"},l({class:"column is-one-fifth"},n({class:"title is-4"},"Backup / Restore")),l({class:"column"},l({style:"border-left: 2px solid; padding-left: 10px;"},c("Export the entire database to create a backup."),i({class:"button is-default",onclick:()=>{s.dashboard.getAllTransactions().then(e=>{if(200===e){let e={transaction:s.dashboard.transactions.val,rules:s.tag.rules.val,tags:s.tag.tags.val},t=JSON.stringify(e);const a=new Blob([t],{type:"text/plain"}),o=document.createElement("a");o.href=window.URL.createObjectURL(a);let l=new Date;o.download=`budget-backup_${l.getFullYear()}-${l.getMonth()+1}.json`,o.click()}})}},"Backup"),c("Restore database from a backup."),i({class:"button is-default",onclick:()=>e()},"Restore"),r({type:"file",name:"files[]",id:"file",style:"opacity: 0",multiple:""}))))},{div:d,h4:p,p:f,button:m,input:y,label:b,br:g}=e.tags,k=()=>{let t=e.state(0);return d({class:"columns"},d({class:"column is-one-fifth"},p({class:"title is-4"},"Tag Rule")),d({class:"column"},d({style:"border-left: 2px solid; padding-left: 10px;"},f("Start the tag generator."),d({class:"control"},b({class:"radio"},y({type:"radio",name:"runType",class:"radio",checked:()=>0===t.val,onclick:()=>t.val=0}),"Blanks only"),g(),b({class:"radio"},y({type:"radio",name:"runType",class:"radio",checked:()=>1===t.val,onclick:()=>t.val=1}),"All records")),m({class:"button is-default",onclick:()=>{s.dashboard.getAllTransactions().then(e=>{if(200===e){let e=new Array;0===t.val?s.dashboard.transactions.val.filter(e=>null==e.tag||""==e.tag).forEach(t=>{t.tag=s.tag.generateTag(t),e.push(t)}):1===t.val&&s.dashboard.transactions.val.forEach(t=>{t.tag=s.tag.generateTag(t),e.push(t)}),e.length>0?s.transaction.saveTransactions(e).then(e=>{200===e&&o({type:"success",message:"Completed successful."})}):o({type:"info",message:"No transactions found."})}})}},"Run Rules"))))},{div:h,h4:w,p:R,button:x}=e.tags,{div:v}=e.tags,T=()=>v({class:"container mt-2"},u(),k(),h({class:"columns"},h({class:"column is-one-fifth"},w({class:"title is-4"},"Reset")),h({class:"column"},h({style:"border-left: 2px solid; padding-left: 10px;"},R("Reset the database to a clean slate. Make sure you have a backup!"),x({class:"button is-danger",onclick:()=>{a({title:"Reset confirmation?",message:"Are you sure you want to reset the database? This cannot be undone.",type:"yesno"}).then(e=>{e&&s.transaction.resetTansactions().then(()=>o({type:"success",message:"Database reset successful."}))})}},"Reset")))));export{T as Settings};
